# -*- coding: utf-8 -*-
"""
Последняя очистка - только точные замены
"""

with open('generate/admin.py', 'r', encoding='utf-8') as f:
    content = f.read()

# Точные замены только битых фрагментов (не трогая правильный текст)
precise_fixes = [
    ('"""Настройки� Поддерживаемые референсы� � ������."""', '"""Отображает поддерживаемые референсы в удобном виде."""'),
    ('"������, Настройки���� ��� Категория"', '"Модели, доступные для генерации"'),
    ('# -- Доступные модели�� ��� ����� --------------------------------', '# -- Категории промптов для видео --------------------------------'),
    ('# -- ���Доступные модели����� ������� (Настройки�) ----------------', '# -- Конфигурация соотношений сторон (универсальная) ----------------'),
    ('"������� Доступные модели"', '"Размеры (варианты обоих)"'),
    ('("���Доступные модели����� ������ � ��������", {', '("Конфигурация соотношений сторон и качества", {'),
    ('"Доступные модели��� ��Доступные модели � �������� ��� �������"', '"Доступные варианты соотношения сторон и качества для генерации"'),
    ('"������ � ������� Настройки�"', '"Сортировка и внешний вид"'),
    ('# Доступные модели������ ��Доступные модели', '# Сохранить конфигурацию соотношения сторон'),
    ('# -- Настройки�� ����� ������� (Настройки�) ---------------------', '# -- Конфигурация моделей изображений (универсальная) ---------------------'),
    ('Inline ��� Поддерживаемые референсы��� ����� � ������', 'Inline для редактирования соотношений сторон и качества у модели'),
    ('("����Доступные модели�", {', '("Примеры разрешений", {'),
    ('"�������: 1920x1080, 3840x2160"', '"Примеры: 1920x1080, 3840x2160"'),
]

for old, new in precise_fixes:
    if old in content:
        content = content.replace(old, new)
        print(f"✓ Заменено: {old[:50]}...")
    else:
        print(f"✗ Не найдено: {old[:50]}...")

with open('generate/admin.py', 'w', encoding='utf-8') as f:
    f.write(content)

print('\n✅ Точные замены выполнены!')

# Финальная проверка
broken_count = content.count('\ufffd')
print(f'Осталось битых символов \\ufffd: {broken_count}')
